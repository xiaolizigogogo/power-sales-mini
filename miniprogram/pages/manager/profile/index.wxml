<!--pages/manager/profile/index.wxml-->
<view class="profile-container">
  <permission-guard required-user-type="manager">
    
    <!-- å¤´éƒ¨ç”¨æˆ·ä¿¡æ¯ -->
    <view class="profile-header">
      <view class="user-avatar" bindtap="onChangeAvatar">
        <view class="avatar-image" style="background-image: url('{{userInfo.avatar}}');">
          <text class="avatar-text" wx:if="{{!userInfo.avatar}}">ğŸ‘¤</text>
        </view>
        <view class="avatar-edit">
          <text class="edit-icon">ğŸ“·</text>
        </view>
      </view>
      
      <view class="user-info">
        <view class="user-name">{{userInfo.name || 'æœªè®¾ç½®å§“å'}}</view>
        <!-- åªæ˜¾ç¤ºéƒ¨é—¨åï¼Œä¸æ˜¾ç¤ºå…¬å¸å -->
        <view class="profile-item">
          <text class="label">éƒ¨é—¨</text>
          <text class="value">{{userInfo.department}}</text>
        </view>
        <view class="user-position">{{userInfo.position || 'å®¢æˆ·ç»ç†'}}</view>
        <view class="user-status">
          <text class="status-dot {{userInfo.isOnline ? 'online' : 'offline'}}"></text>
          <text class="status-text">{{userInfo.isOnline ? 'åœ¨çº¿' : 'ç¦»çº¿'}}</text>
        </view>
      </view>
      
      <view class="user-edit" bindtap="onEditProfile">
        <text class="edit-icon">âœï¸</text>
      </view>
    </view>
    
    <!-- è´¦æˆ·ä¿¡æ¯ -->
    <view class="info-section">
      <view class="section-title">è´¦æˆ·ä¿¡æ¯</view>
      <view class="info-list">
        <view class="info-item" bindtap="onShowAccountInfo">
          <view class="info-label">
            <text class="info-icon">ğŸ‘¤</text>
            <text>ç™»å½•è´¦æˆ·</text>
          </view>
          <view class="info-value">
            <text>{{userInfo.username || 'æœªè®¾ç½®'}}</text>
            <text class="arrow-icon">â€º</text>
          </view>
        </view>
        
        <view class="info-item" bindtap="onBindWechat">
          <view class="info-label">
            <text class="info-icon">ğŸ’¬</text>
            <text>å¾®ä¿¡ç»‘å®š</text>
          </view>
          <view class="info-value">
            <text class="{{userInfo.isWechatBound ? 'bound' : 'unbound'}}">
              {{userInfo.isWechatBound ? 'å·²ç»‘å®š' : 'æœªç»‘å®š'}}
            </text>
            <text class="arrow-icon">â€º</text>
          </view>
        </view>
        
        <view class="info-item" bindtap="onChangePassword">
          <view class="info-label">
            <text class="info-icon">ğŸ”’</text>
            <text>ä¿®æ”¹å¯†ç </text>
          </view>
          <view class="info-value">
            <text class="arrow-icon">â€º</text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- ä¸šç»©ç»Ÿè®¡ -->
    <view class="stats-section">
      <view class="section-title">æœ¬æœˆä¸šç»©</view>
      <view class="stats-grid">
        <view class="stat-item" bindtap="onViewCustomers">
          <view class="stat-number">{{stats.customerCount || 0}}</view>
          <view class="stat-label">å®¢æˆ·æ•°é‡</view>
        </view>
        <view class="stat-item" bindtap="onViewFollows">
          <view class="stat-number">{{stats.followCount || 0}}</view>
          <view class="stat-label">è·Ÿè¿›æ¬¡æ•°</view>
        </view>
        <view class="stat-item" bindtap="onViewOrders">
          <view class="stat-number">{{stats.orderCount || 0}}</view>
          <view class="stat-label">è®¢å•æ•°é‡</view>
        </view>

      </view>
    </view>
    
    <!-- åŠŸèƒ½èœå• -->
    <view class="menu-section">
      <view class="section-title">åŠŸèƒ½èœå•</view>
      <view class="menu-list">
        <view class="menu-item" bindtap="onViewWorkplace">
          <text class="menu-icon">ğŸ¢</text>
          <text class="menu-text">å·¥ä½œå°</text>
          <text class="arrow-icon">â€º</text>
        </view>
        
        <view class="menu-item" bindtap="onViewCustomers">
          <text class="menu-icon">ğŸ‘¥</text>
          <text class="menu-text">å®¢æˆ·ç®¡ç†</text>
          <text class="arrow-icon">â€º</text>
        </view>
        
        <view class="menu-item" bindtap="onViewFollows">
          <text class="menu-icon">ğŸ“</text>
          <text class="menu-text">è·Ÿè¿›ç®¡ç†</text>
          <text class="arrow-icon">â€º</text>
        </view>
        
        <view class="menu-item" bindtap="onViewPerformance">
          <text class="menu-icon">ğŸ“Š</text>
          <text class="menu-text">ä¸šç»©æŸ¥çœ‹</text>
          <text class="arrow-icon">â€º</text>
        </view>
        
        <view class="menu-item" bindtap="onViewSettings">
          <text class="menu-icon">âš™ï¸</text>
          <text class="menu-text">è®¾ç½®</text>
          <text class="arrow-icon">â€º</text>
        </view>
      </view>
    </view>
    
    <!-- é€€å‡ºç™»å½• -->
    <view class="logout-section">
      <view class="logout-btn" bindtap="onLogout">
        <text>é€€å‡ºç™»å½•</text>
      </view>
    </view>
    
    <!-- ç‰ˆæœ¬ä¿¡æ¯ -->
    <view class="version-section">
      <view class="version-info">
        <text class="version-text">ç‰ˆæœ¬å·ï¼š{{version}}</text>
        <text class="update-time">æ›´æ–°æ—¶é—´ï¼š{{updateTime}}</text>
      </view>
    </view>
    
    <!-- è´¦æˆ·ä¿¡æ¯å¼¹çª— -->
    <van-popup show="{{showAccountInfo}}" position="bottom" round bind:close="onCloseAccountInfo">
      <view class="account-popup">
        <view class="popup-header">
          <text class="popup-title">è´¦æˆ·ä¿¡æ¯</text>
          <text class="close-icon" bindtap="onCloseAccountInfo">Ã—</text>
        </view>
        
        <view class="account-info">
          <view class="account-item">
            <text class="account-label">ç”¨æˆ·å</text>
            <text class="account-value">{{userInfo.username}}</text>
          </view>
          <view class="account-item">
            <text class="account-label">æ‰‹æœºå·</text>
            <text class="account-value">{{userInfo.phone}}</text>
          </view>
          <view class="account-item">
            <text class="account-label">é‚®ç®±</text>
            <text class="account-value">{{userInfo.email}}</text>
          </view>
          <view class="account-item">
            <text class="account-label">æ³¨å†Œæ—¶é—´</text>
            <text class="account-value">{{userInfo.registerTime}}</text>
          </view>
          <view class="account-item">
            <text class="account-label">æœ€åç™»å½•</text>
            <text class="account-value">{{userInfo.lastLoginTime}}</text>
          </view>
        </view>
        
        <view class="account-actions">
          <view class="action-btn secondary" bindtap="onBindWechat">
            {{userInfo.isWechatBound ? 'è§£ç»‘å¾®ä¿¡' : 'ç»‘å®šå¾®ä¿¡'}}
          </view>
          <view class="action-btn primary" bindtap="onChangePassword">
            ä¿®æ”¹å¯†ç 
          </view>
        </view>
      </view>
    </van-popup>
    
  </permission-guard>
</view> 