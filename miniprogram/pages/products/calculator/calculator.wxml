<view class="container">
  <!-- 产品信息 -->
  <view class="product-info" wx:if="{{ product }}">
    <view class="product-name">{{ product.name }}</view>
    <view class="product-price">
      <text class="price-label">电价：</text>
      <text class="price-value">¥{{ product.price }}/度</text>
    </view>
  </view>

  <!-- 计算表单 -->
  <view class="calculator-form">
    <!-- 用电类型 -->
    <view class="form-item">
      <view class="form-label">用电类型</view>
      <van-radio-group value="{{ type }}" bind:change="onTypeChange">
        <van-radio name="commercial">工商业用电</van-radio>
        <van-radio name="residential">居民用电</van-radio>
      </van-radio-group>
    </view>

    <!-- 用电量输入 -->
    <view class="form-item">
      <view class="form-label">月均用电量（度）</view>
      <van-field
        value="{{ consumption }}"
        type="digit"
        placeholder="请输入月均用电量"
        border="{{ false }}"
        bind:change="onConsumptionChange"
      />
    </view>

    <!-- 峰谷时段 -->
    <view class="form-item">
      <view class="form-label">峰谷时段用电比例</view>
      <view class="slider-box">
        <view class="slider-label">峰时段：{{ peakPercent }}%</view>
        <van-slider
          value="{{ peakPercent }}"
          min="0"
          max="100"
          step="5"
          bind:change="onPeakChange"
        />
      </view>
      <view class="slider-box">
        <view class="slider-label">谷时段：{{ 100 - peakPercent }}%</view>
        <van-slider
          value="{{ 100 - peakPercent }}"
          min="0"
          max="100"
          step="5"
          disabled
        />
      </view>
    </view>

    <!-- 计算按钮 -->
    <view class="form-actions">
      <van-button 
        type="primary" 
        block 
        color="#409EFF"
        bind:click="calculate"
      >开始计算</van-button>
    </view>
  </view>

  <!-- 计算结果 -->
  <view class="result-section" wx:if="{{ showResult }}">
    <view class="result-title">计算结果</view>
    
    <!-- 月度电费 -->
    <view class="result-card">
      <view class="result-header">
        <text>月度电费</text>
        <text class="compare-text">对比</text>
      </view>
      <view class="result-content">
        <view class="result-item">
          <text class="item-label">现有电价</text>
          <text class="item-value">¥{{ results.currentBill }}</text>
        </view>
        <view class="result-item highlight">
          <text class="item-label">优惠电价</text>
          <text class="item-value">¥{{ results.newBill }}</text>
        </view>
        <view class="result-item savings">
          <text class="item-label">月度节省</text>
          <text class="item-value">¥{{ results.monthlySavings }}</text>
        </view>
      </view>
    </view>

    <!-- 年度节省 -->
    <view class="result-card">
      <view class="result-header">
        <text>年度节省</text>
      </view>
      <view class="annual-savings">
        <text class="savings-value">¥{{ results.annualSavings }}</text>
        <text class="savings-label">预计年度节省金额</text>
      </view>
      <view class="savings-tips">
        <text class="tip-text">* 实际节省金额可能因用电情况变化而有所不同</text>
      </view>
    </view>

    <!-- 操作按钮 -->
    <view class="result-actions">
      <van-button 
        type="default" 
        block 
        bind:click="recalculate"
      >重新计算</van-button>
      <van-button 
        type="primary" 
        block 
        color="#409EFF"
        bind:click="createOrder"
      >立即购买</van-button>
    </view>
  </view>
</view> 