<!-- components/image-preview/index.wxml -->
<view class="image-preview" wx:if="{{show}}" bindtap="onClose">
  <!-- èƒŒæ™¯é®ç½© -->
  <view class="image-preview__mask"></view>
  
  <!-- å›¾ç‰‡å®¹å™¨ -->
  <view class="image-preview__container" bindtap="onStopPropagation">
    <!-- å›¾ç‰‡è½®æ’­ -->
    <swiper 
      class="image-preview__swiper"
      current="{{swiperCurrent}}"
      bindchange="onSwiperChange"
      indicator-dots="{{images.length > 1}}"
      indicator-color="rgba(255, 255, 255, 0.3)"
      indicator-active-color="#ffffff"
      circular="{{images.length > 1}}"
    >
      <swiper-item 
        wx:for="{{images}}" 
        wx:key="index"
        class="image-preview__item"
      >
        <!-- åŠ è½½çŠ¶æ€ -->
        <view 
          class="image-preview__loading" 
          wx:if="{{!imageLoaded[index] && !imageError[index]}}"
        >
          <text class="loading-text">åŠ è½½ä¸­...</text>
        </view>
        
        <!-- åŠ è½½å¤±è´¥çŠ¶æ€ -->
        <view 
          class="image-preview__error" 
          wx:if="{{imageError[index]}}"
        >
          <text class="error-icon">ğŸ“·</text>
          <text class="error-text">å›¾ç‰‡åŠ è½½å¤±è´¥</text>
        </view>
        
        <!-- å›¾ç‰‡ -->
        <image 
          class="image-preview__image"
          src="{{item}}"
          mode="aspectFit"
          data-index="{{index}}"
          bindload="onImageLoad"
          binderror="onImageError"
          bindtap="onDoubleTap"
          wx:if="{{!imageError[index]}}"
        />
      </swiper-item>
    </swiper>
    
    <!-- å›¾ç‰‡ç´¢å¼• -->
    <view class="image-preview__index" wx:if="{{images.length > 1}}">
      {{currentIndex + 1}} / {{images.length}}
    </view>
    
    <!-- æ“ä½œæŒ‰é’® -->
    <view class="image-preview__actions">
      <!-- åˆ é™¤æŒ‰é’® -->
      <view 
        class="action-btn delete-btn" 
        wx:if="{{showDelete}}"
        bindtap="onDelete"
      >
        <text class="action-icon">ğŸ—‘ï¸</text>
      </view>
      
      <!-- ä¸‹è½½æŒ‰é’® -->
      <view 
        class="action-btn download-btn" 
        wx:if="{{showDownload}}"
        bindtap="onDownload"
      >
        <text class="action-icon">ğŸ“¥</text>
      </view>
      
      <!-- åˆ†äº«æŒ‰é’® -->
      <view 
        class="action-btn share-btn" 
        wx:if="{{showShare}}"
        bindtap="onShare"
      >
        <text class="action-icon">ğŸ“¤</text>
      </view>
    </view>
    
    <!-- å…³é—­æŒ‰é’® -->
    <view class="image-preview__close" bindtap="onClose">
      <text class="close-icon">âœ•</text>
    </view>
  </view>
</view> 